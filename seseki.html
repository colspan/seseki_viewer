<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
  <title>Seseki Viewer</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="build/seseki.bundle.js"></script>
</head>
<body>
  <header>
    <div class="navbar">
      <nav class="blue darken-3">
        <div class="nav-wrapper container">
          <a style="font-size:14pt" class="page-title">Seseki Viewer</a>
          <a href="" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
        </div>
      </nav>
    </div>
  </header>
  <main>
    <div class="">
      <div class="row">
        <form action="#">
          <div class="file-field input-field col s12 m4 l4 tooltipped" data-position="bottom" data-delay="50" data-tooltip="所定の書式で作成されたCSVファイルを入力できます(UTF-8またはShift-JIS)">
            <div class="btn">
              <span><i class="material-icons">description</i></span>
              <input type="file" accept="csv" id="file_loader" style="display:inline">
            </div>
            <div class="file-path-wrapper">
              <input class="file-path validate" id="file_loader_filename" type="text" value="CSVファイルを開く">
              <label></label>
            </div>
          </div>
          <div class="input-field col s12 m4 l4">
            <select class="browser-default tooltipped" id="sample_data_selector" data-position="bottom" data-delay="50" data-tooltip="サンプルのデータで任意データのヒートマップ表示を体験できます">
              <option value="" disabled selected>サンプルファイルで試す</option>
            </select>
          </div>
          <div class="input-field col s12 m4 l4 tooltipped" data-position="bottom" data-delay="50" data-tooltip="スプレッドシートでデータを編集できます">
            <a href="#modal_spreadsheet" class="btn modal-trigger" style="height:45px;"><i class="material-icons">launch</i> スプレッドシート編集する</a>
          </div>
        </form>
      </div>
      <nav class="blue darken-3">
        <div class="row">
          <div class="col s12 m6 l6">
            <h2 style="margin:18px 0 0 10px" id="report_title">ファイルを入力してください</h2>
          </div>
          <div class="col s12 m6 l6">
            <div class="input-field browser-default tooltipped" id="map_datatype_selector" data-position="bottom" data-delay="50" data-tooltip="表示項目を選択できます"></div>
          </div>
        </div>
      </nav>
      <div class="row" id="main_view">
        <div class="col s12 m9 l9" id="map_container"></div>
        <div class="col s12 m3 l3" id="ranking_view">
          <div id="ranking_container">
            <table><thead><th>順位</th><th>市町村名</th><th>値</th></thead><tbody id="ranking_table"></tbody></table>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="card blue-grey darken-1" id="data-info" style="visibility:hidden;">
          <div class="card-content white-text">
            <span class="card-title"><span id="data-title"></span></span>
            <p><span id="data-description"></span></p>
            <p>権利元 : <a class="yellow-text" href="#" id="data-url"></a> (<a class="yellow-text" href="#" id="convertedcsv-url">変換済CSVファイル</a>)</p>
          </div>
        </div>
      </div>

    </div>
    <div id="myModal" class="modal modal-fixed-footer">
      <div class="modal-content">
        <h4 class="modal-title tooltipped" id="modal_commune_name" data-position="bottom" data-delay="50" data-tooltip=""></h4>
        <div class="modal-body" id="modal_commune_data"></div>
      </div>
      <div class="modal-footer">
         <a href="#!" class="modal-action modal-close waves-effect waves-green btn">閉じる</a>
      </div>
    </div>

    <!-- スプレッドシート -->
     <div id="modal_spreadsheet" class="modal bottom-sheet">
       <div class="modal-content">
         <div id="spreadsheet"></div>
       </div>
       <div class="modal-footer">
         <div class="chip blue lighten-4">Excel等からコピー&amp;ペーストで入力できます。</div>
         <div class="chip red accent-1">※ブラウザを閉じるとデータが消えますので注意してください</div>
         <a href="#!" class="modal-action modal-close waves-effect waves-green btn">ヒートマップを更新する</a>
       </div>
     </div>
  </main>
  <footer class="page-footer blue darken-3">
    <div class="footer-copyright blue darken-4" style="height:120px;">
      <div class="container">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a> <a xmlns:cc="http://creativecommons.org/ns#" href="https://github.com/colspan/seseki_viewer" property="cc:attributionName" rel="cc:attributionURL">Kunihiko Miyoshi</a> 作『<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Seseki Viewer</span>』は<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">クリエイティブ・コモンズ 表示 - 非営利 - 継承 4.0 国際 ライセンス</a>で提供されています。
      </div>
    </div>
  </footer>

  <script>
var prefecture_datalist = ["01_hokkaido", "02_aomori", "03_iwate", "04_miyagi", "05_akita", "06_yamagata", "07_fukushima", "08_ibaraki", "09_tochigi", "10_gumma", "11_saitama", "12_chiba", "13_tokyo", "14_kanagawa", "15_niigata", "16_toyama", "17_ishikawa", "18_fukui", "19_tamanashi", "20_nagano", "21_gifu", "22_shizuoka", "23_aichi", "24_mie", "25_shiga", "26_kyoto", "27_osaka", "28_hyogo", "29_nara", "30_wakayama", "31_tottori", "32_shimane", "33_okayama", "34_hiroshima", "35_yamaguchi", "36_tokushima", "37_kagawa", "38_ehime", "39_kochi", "40_fukuoka", "41_saga", "42_nagasaki", "43_kumamoto", "44_oita", "45_miyagawa", "46_kagoshima", "47_okinawa"];

//  sample_data : 'params/sample_data_01_hokkaido.json'

function getUrlVars(){
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split("#")[0].split('&');
    for(var i = 0; i < hashes.length; i++) {
        hash = hashes[i].split('=');
        vars[hash[0]] = hash[1];
    }
    return vars;
}

function execute_seseki(){
  var hash = getUrlVars();
  var target_prefectures = [];
  if(hash.targets){
    hash.targets.split(",").forEach(function(d){
      var value = +d;
      if(d>=0 && d<prefecture_datalist.length){
        target_prefectures.push(value);
      }
    });
  }
  else{
    target_prefectures = [0];
  }

  var geodata_files = [];
  target_prefectures.forEach(function(d){
    geodata_files.push('data/' + prefecture_datalist[d] + '_topo.json');
  });

  var gis_def = {
    geodata_files:geodata_files,
    ref_size : {
      width :  800,
      height:  700
    },
    sample_data : 'params/sample_data_11-14_around_tokyo.json'
  };
  seseki(gis_def);

}


execute_seseki();

  </script>

  <!-- Google Analytics -->
</body>
